http://security.stackexchange.com/questions/33585/what-do-i-need-to-do-to-secure-log-in-and-registration-for-my-website
http://security.stackexchange.com/questions/55789/secure-custom-registration-links
http://security.stackexchange.com/questions/tagged/web-application?sort=votes&pageSize=15
http://security.stackexchange.com/questions/tagged/authentication?sort=votes&pageSize=15
http://security.stackexchange.com/questions/988/is-basic-auth-secure-if-done-over-https
http://security.stackexchange.com/questions/32003/passwords-being-sent-in-clear-text-due-to-users-mistake-in-typing-it-in-the-use
http://security.stackexchange.com/questions/137418/how-does-google-know-where-i-am
http://security.stackexchange.com/questions/8596/https-security-should-password-be-hashed-server-side-or-client-side
http://security.stackexchange.com/questions/23006/client-side-password-hashing
http://security.stackexchange.com/questions/2985/web-security-cheatsheet-todo-list
http://security.stackexchange.com/questions/76779/is-sql-injection-possible-in-this-php-registration-script
http://security.stackexchange.com/questions/33585/what-do-i-need-to-do-to-secure-log-in-and-registration-for-my-website
http://security.stackexchange.com/questions/33793/handling-passwords-in-a-web-application?noredirect=1&lq=1
http://security.stackexchange.com/questions/29742/does-overlaying-the-mouse-on-a-virtual-numeric-keyboard-really-protect-against-k/29744#29744
http://security.stackexchange.com/questions/128412/sql-injection-is-17-years-old-why-is-it-still-around
http://security.stackexchange.com/questions/988/is-basic-auth-secure-if-done-over-https
http://security.stackexchange.com/questions/110676/how-should-i-securely-type-a-password-in-front-of-a-lot-of-people
http://security.stackexchange.com/questions/68009/four-factor-authentication
http://security.stackexchange.com/questions/13026/forgotten-password-or-reset-link-which-is-more-secure-to-email?rq=1
http://security.stackexchange.com/questions/13026/forgotten-password-or-reset-link-which-is-more-secure-to-email?rq=1
http://security.stackexchange.com/questions/117730/why-would-a-website-that-resets-your-password-to-one-of-their-choice-be-consider?noredirect=1&lq=1
http://security.stackexchange.com/questions/105927/password-reset-url-forwarding
http://security.stackexchange.com/questions/6050/real-salt-and-fake-salt
http://security.stackexchange.com/questions/17421/how-to-store-salt
http://security.stackexchange.com/questions/211/how-to-securely-hash-passwords/31846#31846
http://security.stackexchange.com/questions/4781/do-any-security-experts-recommend-bcrypt-for-password-storage
http://security.stackexchange.com/questions/40482/need-references-about-why-public-access-to-a-password-hash-and-salt-is-poor-prac
http://security.stackexchange.com/questions/122999/maximum-reasonable-password-length
http://security.stackexchange.com/questions/33470/what-technical-reasons-are-there-to-have-low-maximum-password-lengths
http://security.stackexchange.com/questions/33470/what-technical-reasons-are-there-to-have-low-maximum-password-lengths
http://security.stackexchange.com/questions/33196/is-there-a-length-beyond-which-increasing-password-length-provides-no-additional
http://security.stackexchange.com/questions/113059/where-to-save-keepass-file
http://security.stackexchange.com/questions/112688/how-can-using-multiple-laptops-improve-security/112737#112737
http://security.stackexchange.com/questions/42788/practical-and-secure-use-of-keepass
http://security.stackexchange.com/questions/3272/password-hashing-add-salt-pepper-or-is-salt-enough
http://security.stackexchange.com/questions/99910/password-hashing-using-2-salts?noredirect=1&lq=1
http://security.stackexchange.com/questions/29745/ive-heard-that-salt-is-not-meant-to-be-secret-but-what-if-i-made-it-secret?noredirect=1&lq=1
http://security.stackexchange.com/questions/29414/when-hashing-passwords-is-it-okay-to-store-the-algorithm-used-right-there-in-th
http://security.stackexchange.com/questions/24449/how-valuable-is-secrecy-of-an-algorithm
http://security.stackexchange.com/questions/17421/how-to-store-salt
http://security.stackexchange.com/questions/51959/why-are-salted-hashes-more-secure-for-password-storage
http://security.stackexchange.com/questions/17421/how-to-store-salt
http://security.stackexchange.com/questions/17421/how-to-store-salt
http://security.stackexchange.com/questions/17421/how-to-store-salt
http://security.stackexchange.com/questions/379/what-are-rainbow-tables-and-how-are-they-used
http://security.stackexchange.com/questions/379/what-are-rainbow-tables-and-how-are-they-used
http://security.stackexchange.com/questions/60691/length-of-passwords-that-are-rainbow-table-safe
http://stackoverflow.com/questions/39123563/what-is-the-difference-between-physical-and-logical-backup
http://stackoverflow.com/questions/290951/best-practices-for-web-login-authentication
http://stackoverflow.com/questions/3715920/is-it-worth-hashing-passwords-on-the-client-side
http://stackoverflow.com/questions/290951/best-practices-for-web-login-authentication
http://stackoverflow.com/questions/1131332/sql-injection-attack-on-asp-registration-form-pages
http://stackoverflow.com/questions/1774876/password-hashing-at-client-browser BAD IDEA
http://stackoverflow.com/questions/16425345/how-to-pass-const-pointer-to-const-object-using-unique-ptr
http://stackoverflow.com/questions/18389537/does-postgresql-serial-work-differently
http://stackoverflow.com/questions/98768/should-i-impose-a-maximum-length-on-passwords
http://stackoverflow.com/questions/6832445/how-can-bcrypt-have-built-in-salts
http://stackoverflow.com/questions/2999197/do-i-need-a-random-salt-once-per-password-or-only-once-per-database
http://stackoverflow.com/questions/16891729/best-practices-salting-peppering-passwords
http://stackoverflow.com/questions/549/the-definitive-guide-to-form-based-website-authentication
http://security.blogoverflow.com/2011/09/qotw-9-what-are-rainbow-tables-and-how-are-they-used
http://stackoverflow.com/questions/12461484/is-it-secure-to-store-passwords-as-environment-variables-rather-than-as-plain-t
http://security.stackexchange.com/questions/83180/secure-database-password-stored-in-an-env-variable
http://security.stackexchange.com/questions/14000/environment-variable-accessibility-in-linux/14009#14009
https://news.ycombinator.com/item?id=8826024
http://rabexc.org/posts/pitfalls-of-ssh-agents
http://unix.stackexchange.com/questions/70709/ssh-agent-dont-forward-authentication-for-the-whole-keyring
https://security.stackexchange.com/questions/9251/what-is-the-security-implications-of-enabling-ssh-onward-connections
http://security.stackexchange.com/questions/78828/how-can-i-prevent-keys-loaded-into-ssh-agent-from-being-sent-to-a-particular-in
https://news.ycombinator.com/item?id=9425805
https://security.stackexchange.com/questions/183083/is-it-safe-wise-to-store-a-salt-in-the-same-field-as-the-hashed-password

[CORS explained](https://news.ycombinator.com/item?id=17224772)

https://wiki.mozilla.org/Security/Origin
https://seclab.stanford.edu/websec/csrf/csrf.pdf
https://mixmax.com/blog/cors
https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet#Checking_the_Origin_Header

https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS

https://stackoverflow.com/questions/15988323/cors-and-origin-header

https://www.reddit.com/r/programmingcirclejerk/comments/8t3cu8/ive_always_liked_the_concept_of_a_localhostd_web/e14zp9h/

It's a very, very hard solution to secure properly. My team built and ran one for 4-5 years with millions of installs. Although we never did anything as dumb as the eDellRoot issue from 2015, we ran into a lot of little issues that were easy to miss but could allow attackers to bypass at least some of your defenses. Are you checking CORS properly, or can an attacker forcing you to visit http://google.com.malware.io bypass your checks? Are your domains free from open redirects that would allow an attacker to fake a Referer header from your site? Are you checking that the Host header is localhost to thwart DNS rebinding attacks?

Not to mention, no one issues HTTPS certs for localhost, so you're stuck on HTTP unless your installer forces the PC to trust an unsigned cert (but don't pull a Superfish by issuing identical certs to every install!).

The localhost server allowed us to get rid of all of our browser plugins (which luckily coincided with Mozilla shuttering NPAPI and Chrome neutering its webstore plugins to introduce Native Messaging), which was awesome because we could deliver a single application that more or less "just worked" in all major browsers, but I promise you, the way is fraught with danger.

Eventually we shuttered the server, replacing it with a WPF UI (it was Windows-only already) because there were too many risks (e.g. you can never turn off the web server, even when the user isn't interacting with the application, because there is no reliable way to turn it back on). RIP but it was fun while it lasted.

https://tomforb.es/dell-system-detect-rce-vulnerability
https://tomforb.es/hp-support-solutions-framework-security-issue
https://bugs.chromium.org/p/project-zero/issues/detail?id=693
https://bugs.chromium.org/p/project-zero/issues/detail?id=1447

[There's more to HTML escaping than &, <, >, and "](https://wonko.com/post/html-escaping)

[You don’t need that Bastion host](https://medium.com/@henriksylvesterpedersen/you-dont-need-that-bastion-host-cd1b1717a9e7) [lobsters](https://lobste.rs/s/yi6aeq/you_don_t_need_bastion_host)

>  you can (and IMO should) use ProxyJump/ProxyCommand instead of agent forwarding

> Any non trivial tool will be able to quickly port scan the local subnets and jump along, so they don’t slow attackers: Maybe you should have talked to an attacker before writing this. I almost never port scan unless it’s my last resort. ARP tables, routes, configuration files, and connected ssh-agents are the name of the game. A proper bastion shouldn’t be giving these access parameters, seriously prevent shell access, chroot, and like vbernat said use the ProxyJump command and an ssh_config.

[My arsenal of AWS security tools](https://blyx.com/2018/07/18/my-arsenal-of-aws-security-tools/)

[Chaff Bugs: Deterring Attackers by Making Software Buggier](https://arxiv.org/abs/1808.00659)

[Software Security is a Programming Languages Issue](http://www.pl-enthusiast.net/2018/08/13/security-programming-languages-issue/)

[The secure developer podcast](https://www.heavybit.com/library/podcasts/the-secure-developer/)

https://www.slideshare.net/radcortez/deconstructing-and-evolving-rest-security-117402065
https://tools.ietf.org/html/draft-cavage-http-signatures-10

insecure transit https://www.youtube.com/watch?v=Knk8rUTGkKU

First, a definition from Chrome:

Same-site cookies (née "First-Party-Only" (née "First-Party")) allow servers to mitigate the risk of CSRF and information leakage attacks by asserting that a particular cookie should only be sent with requests initiated from the same registrable domain.

So what does this protect against?

CSRF?

Same-site cookies can effectively prevent CSRF attacks. Why?

If you set the session cookie as same site, it will only be sent if a request emanates from your site. So a standard CSRF attack where the attacker lures the victim to the site http://malicious.comthat posts a request to http://bank.com/transfer.php?amount=10000&receiver=evil_hacker will not work. Since malicious.com is not the same origin as bank.com, the browser will not send the session cookie, and transfer.php will execute as if the victim was not logged in.

This is very similar to how setting a X-Csrf-Token HTTP header protects you from CSRF - again there is something that is only sent if the request emanates from your domain. The same-site property turns your session cookie into a CSRF-token.

So problem solved? Well, sort of. There are some caveats:

·        This will only work for browsers that implement this feature. So far, very few do. Unless you want to throw everybody who uses a slightly older browser under the bus, you will still need to implement an old fashioned CSRF-token.

·        If you need more fine-grained control, this will not be enough. If you run a system that displays untrusted user content, like a forum, you don't want requests originating from user posts to be treated as valid. If someone posts a link to http://myforum.com/?action=delete_everythingyou don't want that to delete anything just because a user clicks it. With a traditional CSRF-token, you can control exactly when it is used. With a same-site cookie, you can not.

·        The same old caveats as for old fashioned CSRF protections still apply. If you have an XSS vulnerability, no CSRF protection in this world will safe you.

With that said, the same-site cookie is still a good thing that should be used together with traditional defences as defence in depth.

XSS and XSSI?

The same-site cookie does nothing to protect you from ordinary XSS attacks. If a hacker manages to fool your site to echo out script from the URL on your site, it will be executed as coming from your origin (after all, it is), and thus session cookies will still be sent with all requests the injected script makes to your domain.

If you read the quote in your post carefully, you will see it says XSSI with an I at the end, and not XSS. The I stands for inclusion, and XSSI is related to, but different from, XSS. Here is a good explanation of XSSI and how it differes from XSS:

XSSI is a form of XSS that takes advantage of the fact that browsers don't prevent webpages from including resources like images and scripts, which are hosted on other domains and servers. [...] For example, if Bank ABC's site has a script that reads a user's private account information, a hacker could include that script in their own malicious site (www.fraudulentbank.com) to pull information from Bank ABC's servers whenever a client of Bank ABC visits the hacker's site.

Same-site cookies protects you from XSSI, since a session cookie would not be sent with the request for the script and it would thus not return any sensitive information. However, for ordinary XSS it makes no difference.

https://news.ycombinator.com/item?id=18134114 CORS

https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Origin

Limiting the possible Access-Control-Allow-Origin values to a set of allowed origins requires code on the server side to check the value of the Origin request header, compare that to a list of allowed origins, and then if the Origin value is in the list, to set the Access-Control-Allow-Origin value to the same value as the Origin value.

Remember that the “Origin” header can’t be set by the application!

https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Origin

The Origin request header indicates where a fetch originates from. It doesn't include any path information, but only the server name. It is sent with CORSrequests, as well as with POST requests. It is similar to the Referer header, but, unlike this header, it doesn't disclose the whole path.

https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy

https://stackoverflow.com/questions/42239643/when-does-firefox-set-the-origin-header-to-null-in-post-requests

https://stackoverflow.com/a/42242802

The CORS protocol consists of a set of headers that indicates whether a response can be shared cross-origin.

Red herring: cors n’ xss

https://security.stackexchange.com/questions/108835/how-does-cors-prevent-xss

https://security.stackexchange.com/questions/97825/is-cors-helping-in-anyway-against-cross-site-forgery

https://security.stackexchange.com/questions/44394/how-to-stop-other-websites-from-sending-cross-domain-ajax-requests

https://security.stackexchange.com/questions/8264/why-is-the-same-origin-policy-so-important

https://developer.mozilla.org/es/docs/Web/HTTP/Access_control_CORS

https://stackoverflow.com/questions/28527790/does-cors-and-xss-have-any-connection

https://www.thepolyglotdeveloper.com/2014/08/bypass-cors-errors-testing-apis-locally/

https://mixmax.com/blog/modern-csrf

https://stackoverflow.com/questions/24680302/csrf-protection-with-cors-origin-header-vs-csrf-token

https://security.stackexchange.com/questions/97825/is-cors-helping-in-anyway-against-cross-site-forgery

https://security.stackexchange.com/questions/188315/is-every-site-without-a-csrf-token-vulnerable-to-csrf-attack

https://security.stackexchange.com/questions/185766/is-cors-and-csrf-tokens-only-for-post-and-get-requests

https://www.quora.com/What-are-the-differences-between-CSRF-and-CORS

https://www.django-rest-framework.org/topics/ajax-csrf-cors/

https://www.nccgroup.trust/us/about-us/newsroom-and-events/blog/2017/september/common-csrf-prevention-misconceptions/

https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)

https://es.wikipedia.org/wiki/Cross-site_request_forgery

https://www.quora.com/Does-my-web-browser-share-credentials-or-cookies-with-all-the-different-sites-I-have-open-in-my-tabs

https://stackoverflow.com/questions/27137562/tab-specific-cookies-without-using-sessionstorage-or-any-html5-features

From docs: Data stored using sessionStorage do not persist across browser tabs, even if two tabs both contain webpages from the same domain origin. In other words, data inside sessionStorage is confined to not just the domain and directory of the invoking page, but the browser tab in which the page is contained in. Contrast that to session cookies, which do persist data from tab to tab.

https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Work_with_the_Cookies_API

https://stackoverflow.com/questions/49663003/cookies-and-multiple-tabs

CSRF cookie vs session based tokens

https://stackoverflow.com/questions/5124030/access-all-stored-cookies

https://stackoverflow.com/questions/12370495/share-a-cookie-between-two-websites

https://security.stackexchange.com/questions/121971/will-same-site-cookies-be-sufficent-protection-against-csrf-and-xss

Same-site cookies (née "First-Party-Only" (née "First-Party")) allow servers to mitigate the risk of CSRF and information leakage attacks by asserting that a particular cookie should only be sent with requests initiated from the same registrable domain.

https://www.tarlogic.com/blog/same-site-cookies-ataques-csrf/

https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet

https://stackoverflow.com/questions/29357330/are-domain-specific-cookies-vulnerable-to-csrf

https://stackoverflow.com/questions/33261244/why-same-origin-policy-isnt-enough-to-prevent-csrf-attacks

https://stackoverflow.com/questions/27793424/how-to-implement-csrf-protection-for-cross-domain-requests

https://stackoverflow.com/questions/20504846/why-is-it-common-to-put-csrf-prevention-tokens-in-cookies

An overview of the top web hacking techniques of 2017 https://news.ycombinator.com/item?id=18194611

[On Cross-Site Scripting and Content Security Policy](https://www.telerik.com/blogs/on-cross-site-scripting-and-content-security-policy).

[What is an "opaque response"?](https://www.reddit.com/r/programming/comments/9ucgo4/what_is_an_opaque_response/).

Vault https://news.ycombinator.com/item?id=18602067 
https://latacora.singles/2018/06/12/a-childs-garden.html
https://noncombatant.org/2019/01/06/state-of-security-2019/
https://twitter.com/b0rk/status/1087924449658236929 ssh tips [more](https://twitter.com/b0rk/status/1087936439470444544)
safe client behaviour https://www.usenix.org/conference/srecon18asia/presentation/goh https://www.youtube.com/watch?v=NHNZab_AzZo
https://www.kenforthewin.com/two-factor-auth-with-public-key-cryptography/
https://www.infoq.com/presentations/microservices-security-spring-pcf Microservices Security Patterns & Protocols with Spring & PCF
https://research.swtch.com/tlog
https://people.centos.org/arrfab/Events/Loadays-2019/loadays-2019-ssh-tips.html

[zanzibar](https://news.ycombinator.com/item?id=20132520)

https://www.youtube.com/watch?v=ai0MLsoN0Gk Adding business logic to your tokens. What could possibly go wrong

https://spin.atomicobject.com/2019/06/29/do-i-need-a-vpn/

[How Do You Explain the Unreasonable Effectiveness of Cloud Security?](https://lobste.rs/s/sqs0vq/how_do_you_explain_unreasonable)

https://www.reddit.com/r/programming/comments/dh6xka/the_owasp_top_10_vulnerabilities_list_is_probably/

[crypto-shredding](https://twitter.com/DiazCarrete/status/1187810883113762816)

https://engineering.fb.com/security/delegated-credentials/

https://gravitational.com/blog/ssh-handshake-explained/

https://news.ycombinator.com/item?id=21423130 MITM
https://lobste.rs/s/bejsfb/public_ssh_keys_can_leak_your_private

Can an intermediate CA be trusted like a self-signed root CA? https://security.stackexchange.com/questions/17391/can-an-intermediate-ca-be-trusted-like-a-self-signed-root-ca

> A root CA is actually an illusion. In X.509, there are trust anchors. A trust anchor is, mostly, a name and a public key, which you know a priori and that you trust. Representation of that name and that public key as a "certificate file" (traditionally self-signed) is just a convenient way to keep the trust anchor as a bunch of bytes.

> The selection of one or more trusted CAs is a local decision.

> Update: I've fond an OpenSSL commit that implements adding non-self-signed CA certificates as trust anchors. Unfortunately, this is not yet included in any release version, so all the proposed workarounds in the comments still apply.

> Update 2: OpenSSL now contains this option in the release version, starting from 1.0.2. The corresponding flag for the command line client is partial_chain, and the programmatic flag seems to be X509_V_FLAG_PARTIAL_CHAIN.

> Additionally, I recently had to verify server certificates in Java: At least in the JDK 1.8 version of the Sun JSSE provider's SSL implementation, adding a leaf certificate to the default TrustManager works without any special configurations, and verification succeeds as if the root CA had been provided.

[ssl bumping - fixing clients](https://dev.to/suntong/a-short-guide-on-squid-transparent-proxy-ssl-bumping-k5c)

[TLS increasingly exists in three different worlds](https://utcc.utoronto.ca/~cks/space/blog/tech/TLSThreeWorlds)

[HTTP Desync Attacks with Python and AWS](https://twitter.com/lobsters/status/1239765972782690304)

https://web.stanford.edu/class/cs253/ https://news.ycombinator.com/item?id=22676126

[it is important to realize that CORS is a relaxing of the Same Origin Policy](https://www.nccgroup.trust/uk/about-us/newsroom-and-events/blogs/2017/september/common-csrf-prevention-misconceptions/)

[CORS & CSRF](https://medium.com/@theflyingmantis/cors-csrf-91ba8487c5fd)

[Using CORS policies to implement CSRF protection](https://engineering.mixmax.com/blog/modern-csrf/)

[JAMStack](https://twitter.com/kentcdodds/status/1245762953363615750)

[microservices security patterns](https://developer.okta.com/blog/2020/03/23/microservice-security-patterns)

https://robservatory.com/how-i-lost-control-of-our-bank-accounts-to-a-phone-scammer/

https://nagarrosecurity.com/blog/interactive-buffer-overflow-exploitation

https://blog.hboeck.de/archives/900-Generating-CRIME-safe-CSRF-tokens.html

Haskell and InfoSec https://www.youtube.com/watch?v=RknM0j138PE

Can we talk about client-side certificates? https://www.reddit.com/r/programming/comments/h8rk8d/can_we_talk_about_clientside_certificates/
 
https://news.ycombinator.com/item?id=23552680 Postbank to replace 12M bank cards after employees steal 'master key'

turn on MFA https://krebsonsecurity.com/2020/06/turn-on-mfa-before-crooks-do-it-for-you/

Timeless Timing Attacks: Exploiting Concurrency to Leak Secrets over Remote Connections https://tom.vg/papers/timeless-timing-attack_usenix2020.pdf

Does anyone use advanced database access control anymore? https://lobste.rs/s/x4luho/does_anyone_use_advanced_database_access

https://news.ycombinator.com/item?id=24599837 How to properly manage SSH keys for server access 

https://krebsonsecurity.com/2020/10/amid-an-embarrassment-of-riches-ransom-gangs-increasingly-outsource-their-work/ https://news.ycombinator.com/item?id=24723125

[what happens when you publish secrets in Git](https://news.ycombinator.com/item?id=25013756)

[How to Set Up an SSH Jump Server](https://gravitational.com/blog/ssh-jump-server/)

https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=9186656

https://serverfault.com/questions/1047254/security-should-containers-run-tls-or-can-they-rely-on-its-sidecar
https://crypto.stackexchange.com/questions/87978/why-do-some-people-believe-that-humans-are-bad-at-generating-random-numbers-ch

[Crackpot Cryptography and Security Theater](https://lobste.rs/s/eext9b/crackpot_cryptography_security_theater)

https://www.goldfiglabs.com/guide/saas-cto-security-checklist/

https://twitter.com/IanColdwater/status/1411131037753696256  container breakout

[Programmers Don’t Understand Hash Functions](https://lobste.rs/s/l3tyc2/programmers_don_t_understand_hash)

[Hacking Out of a Network - Computerphile](https://www.youtube.com/watch?v=h7IeCPhTBxs)

[Is it insecure to display the number of characters when users enter a new passphrase?](https://security.stackexchange.com/questions/254788/is-it-insecure-to-display-the-number-of-characters-when-users-enter-a-new-passph)

[The pitfalls of using SSH-agent, or how to use an agent safely](https://rabexc.org/posts/pitfalls-of-ssh-agents) [hn](https://news.ycombinator.com/item?id=28576617)

[SSH Tunneling Explained](https://news.ycombinator.com/item?id=28802493)

[It's Now Possible To Sign Arbitrary Data With Your SSH Keys](https://lobste.rs/s/a0byrl/it_s_now_possible_sign_arbitrary_data_with). [hn](https://news.ycombinator.com/item?id=29208518)

[ssh agent restriction](https://news.ycombinator.com/item?id=29865876). [restricting ssh agent keys](https://news.ycombinator.com/item?id=29816508).

[WebAuthn server library for public key-based authentication](https://discourse.haskell.org/t/webauthn-server-library-for-public-key-based-authentication/3976)

[Guide to Using YubiKey for GPG and SSH](https://news.ycombinator.com/item?id=30081348)

[SSH into private machines from anywhere using Cloudflare Tunnel](https://news.ycombinator.com/item?id=30283987)

[Top 10 web hacking techniques of 2021](https://portswigger.net/research/top-10-web-hacking-techniques-of-2021)

[OAuth Code Flow](https://curity.io/resources/learn/oauth-code-flow/). Seems like there's lots of good info here.

[The Token Handler Pattern for Single Page Applications](https://curity.io/resources/learn/the-token-handler-pattern/)

[COMPARING THE BACKEND FOR FRONTEND (BFF) SECURITY ARCHITECTURE WITH AN SPA UI USING A PUBLIC API](https://damienbod.com/2022/01/10/comparing-the-backend-for-frontend-bff-security-architecture-with-an-spa-ui-using-a-public-api/)

[Web App Security, Understanding the Meaning of the BFF Pattern](https://dev.to/damikun/web-app-security-understanding-the-meaning-of-the-bff-pattern-i85)

[Backend For Frontend Authentication Pattern with Auth0 and ASP.NET Core](https://auth0.com/blog/backend-for-frontend-pattern-with-auth0-and-dotnet/)

[JWT Architecture for Modern Apps](https://levelup.gitconnected.com/secure-jwts-with-backend-for-frontend-9b7611ad2afb)

[avoid exposing OAuth 2.0 tokens to the browser, where security is significantly harder than on the server-side... State between the SPA and the BFF can be handled with a cookie.](https://twitter.com/philippederyck/status/1271327829288837121?lang=en)

[Using www-authenticate for user authentication](https://news.ycombinator.com/item?id=30385666)

> Funny that old things like basic HTTP auth are regularly rediscovered by developers.

[One-time password](https://en.wikipedia.org/wiki/One-time_password). [What is a One-Time Password (OTP)?](https://www.okta.com/blog/2020/06/what-is-a-one-time-password-otp/). [OTP, HOTP and TOTP](https://doubleoctopus.com/security-wiki/authentication/otp-totp-hotp/). [YubiKey](https://en.wikipedia.org/wiki/YubiKey).

[Is there a way to create time based OTP with public/private key](https://security.stackexchange.com/questions/160273/is-there-a-way-to-create-time-based-otp-with-public-private-key)

> In case you are talking about a One Time Password there is a simple reason, why TOTP-Algorithms are using a symmetric key on the client/device and the server side.

[How to secure SSH login with one-time passwords on Linux](https://www.xmodulo.com/secure-ssh-login-one-time-passwords-linux.html)

> As far as SSH authentication is concerned, public key authentication is in general considered more secure than password authentication. However, key authentication is actually not desirable or even less secure if you are logging in from a public or shared computer, where things like stealth keylogger or memory scraper can always a possibility. If you cannot trust the local computer, it is better to use something else. This is when one-time passwords come in handy. As the name implies, each one-time password is for single-use only. Such disposable passwords can be safely used in untrusted environments as they cannot be re-used even when they are stolen.

[How Time-based One-Time Passwords work and why you should use them in your app](https://www.freecodecamp.org/news/how-time-based-one-time-passwords-work-and-why-you-should-use-them-in-your-app-fdd2b9ed43c3/). 
[HMAC-based one-time password](https://en.wikipedia.org/wiki/HMAC-based_one-time_password).

> HOTP stands for “HMAC-Based One-Time Password”. This algorithm was published as RFC4226 by the Internet Engineering Task Force (IETF). HOTP defines an algorithm to create a one time password from a secret key and a counter.

[One-Time Passwords (OTP) - Example](https://cryptobook.nakov.com/more-cryptographic-concepts/one-time-passwords-otp-example)

> We need to create a base32 secret which has to be shared between the authentication server and the client. 

> You can install Google Authenticator from  or  and scan the QR code below

[one-time passwords do not provide non-repudiation](https://techblog.bozho.net/one-time-passwords-do-not-provide-non-repudiation/)

> OTP, or one-time password, used to be mainstream with online banking. You get a dedicated device that generates a 6-digit code which you enter into your online banking in order to login or confirm a transaction. The device (token) is airgapped (with no internet connection), and has a preinstalled secret key that cannot be leaked. This key is symmetric and is used to (depending on the algorithm used) encrypt the current time, strip most of the ciphertext and turn the rest into 6 digits. The server owns the same secret key, does the same operation and compares the resulting 6 digits with the ones provided. If you want a more precise description of (T)OTP – check wikipedia. Of course, there are the SMS OTPs, but they are discouraged and insecure, so I won’t discuss them.

> Hardware tokens are going out of fashion and are being replaced by mobile apps that are much easier to use and still represent a hardware device. There is one major difference, though – the phone is connected to the internet, which introduces additional security risks. But if we try to ignore them, then it’s fine to have the secret key on a smartphone, especially if it supports secure per-app storage, not accessible by 3rd party apps, or even hardware security module with encryption support, which the latest ones do.

> Software “tokens” (mobile apps) often rely on OTPs as well, even though they don’t display the code to the user. This makes little sense, as OTPs are short precisely because people need to enter them. If you send an OTP via a RESTful API, why not just send the whole ciphertext? Or better – do a digital signature on a server-provided challenge.

> But why bother with all of that if you have a mobile app with internet connection? You can just create a digital signature on a unique per-transaction challenge and you get proper non-repudiation. The phone can generate a private key on enrollment and send its public key to the server, which can later be used to verify the signature. You don’t have the bandwidth limitation of the human brain that lead to the requirement of 6 digits, so the signature length can be arbitrarily long (even GPRS can handle digital signatures).

[“banking grade” authentication often means a weak otp](https://www.nextauth.com/banking-grade-login-often-means-weak-otp/)

> The probability of getting a 6 digit OTP correct is one in a million. 

> So, even if an OTP is only valid for 30 seconds and your server blocks users that try too many OTPs in a short amount of time, a hacker can simply try the same OTP for all your users.

> OTP uses a cryptographic Message Authentication Code (MAC) function, where both the server and the mobile share a key. This key needs to available* at the server, because the server needs this key to compute the OTP on its side for comparing it with the received OTP. 

> This makes the server a very interesting target, since the attacker getting hold of these keys, can impersonate all these users. In banks this is solved by installing very costly Hardware Security Modules (HSM). These HSMs ensure that the keys will never leak from the server. However, this is typically not done by providers of “banking grade” authentication since this would drive up the total cost of ownership to unacceptable levels.

> nextAuth has the same advantages and none of shortcomings of OTPs over passwords. nextAuth uses public key cryptography, where the server has public keys and the mobile the corresponding private keys. 

[What is the risk and mitigation of accidentally typing a YubiKey password in an open forum?](https://security.stackexchange.com/questions/30891/what-is-the-risk-and-mitigation-of-accidentally-typing-a-yubikey-password-in-an)

[Why is Webauthn not used as primary authentication method?](https://security.stackexchange.com/questions/245419/why-is-webauthn-not-used-as-primary-authentication-method)

> In theory, authenticating with a public key should be much simpler than with a password. There is nothing to remember for the end-user, and registration can be done just by clicking a button. For all intents and purposes, this should be much more user-friendly than a traditional password-based authentication.

> I am at my friend's place and I get an alert on my phone that someone wired some money out of my bank account! I need to login to my bank's site to check whats up. But, my public key/cert is in my computer and I have not registered to the bank using my friend's machine. Or I forgot to carry my Yubikeys with me. Now what do I do to quickly login?

[WebAuthn](https://webauthn.guide/)

> The Web Authentication API (also known as WebAuthn) is a specification written by the W3C and FIDO, with the participation of Google, Mozilla, Microsoft, Yubico, and others. The API allows servers to register and authenticate users using *public key cryptography* instead of a password.

> It allows servers to integrate with the strong authenticators now built into devices, like Windows Hello or Apple’s Touch ID. Instead of a password, a private-public keypair (known as a credential) is created for a website. The private key is stored securely on the user’s device; a public key and randomly generated credential ID is sent to the server for storage. The server can then use that public key to prove the user’s identity.

> The public key is not secret, because it is effectively useless without the corresponding private key. The fact that the server receives no secret has far-reaching implications for the security of users and organizations. Databases are no longer as attractive to hackers, because the public keys aren’t useful to them.

[Web Authentication: An API for accessing Public Key Credentials Level 2](https://www.w3.org/TR/webauthn-2/)

[How to use FIDO2 USB authenticators with SSH](https://www.stavros.io/posts/u2f-fido2-with-ssh/). [FIDO vs SSH](https://news.ycombinator.com/item?id=19520672). [On ubuntu](https://ubuntu.com/blog/enhanced-ssh-and-fido-authentication-in-ubuntu-20-04-lts).

> One of the most exciting security enhancements in Ubuntu 20.04 LTS (Focal Fossa) is the ability to use the Fast Identity Online (FIDO) or Universal 2nd Factor (U2F) devices with SSH.

[GitHub - Security keys are now supported for SSH Git operations](https://github.blog/2021-05-10-security-keys-supported-ssh-git-operations/)

>  We were an early adopter of Universal 2nd Factor (“U2F”) and were also one of the first sites to transition to Webauthn. We’re always on the lookout for new standards that both increase security and usability. Today we’re taking the next step by shipping support for security keys when using Git over SSH.

> Security keys, such as the YubiKey, are portable and transferable between machines in a convenient form factor. Most security keys connect via USB, NFC, or Bluetooth. When used in a web browser with two-factor authentication enabled, security keys provide a strong, convenient, and phishing-proof alternative to one-time passwords provided by applications or SMS. Much of the data on the key is protected from external access and modification, ensuring the secrets cannot be taken from the security key. Security keys should be protected as a credential, so keep track of them and you can be confident that you have usable, strong authentication. As long as you retain access to the security key, you can be confident that it can’t be used by anyone else for any other purpose.

[Yubico - What is webauthn](https://www.yubico.com/authentication-standards/webauthn/)

> WebAuthn is an API that makes it very easy for a relying party, such as a web service, to integrate strong authentication into applications using support built in to all leading browsers and platforms. This means that web services can now easily offer their users strong authentication with a choice of authenticators such as security keys or built-in platform authenticators such as biometric readers.

> The recommended approach is for the user to first register using an external authenticator that is phishing resistant, *and then transfer that trust (bootstrap)* to a built-in platform authenticator for subsequent authentication. The benefit of this approach is that if the device is compromised in any way (lost or stolen), then the user still has an external authenticator as a portable root of trust that can be used to quickly onboard a new device and re-authenticate to the web service.

[A YubiKey with OpenPGP can be used for logging in to remote SSH servers.](https://developers.yubico.com/PGP/SSH_authentication/) 

> In this setup, the Authentication subkey of an OpenPGP key is used as an SSH key to authenticate against a server. 

[Establishing a Secure Portable Root of Trust with WebAuthn (pdf)](https://dtasiagroup.com/wp-content/uploads/2021/02/Establishing_a_Secure_Portable_Root_of_Trust_with_WebAuthn.pdf)

[A look at password security, Part IV: WebAuthn](https://blog.mozilla.org/en/mozilla/password-security-part-iv-webauthn/)

> public key authentication is great in principle but in practice has been hard to integrate into the Web environment. However, we’re now seeing deployment of a new technology called WebAuthn (short for Web Authentication) that hopefully changes that.

> Previous approaches to public key authentication required the browser to provide the user interface. For a variety of reasons (the interfaces were bad, the sites wanted to control the experience) this didn’t work well for sites, and public key authentication didn’t get much adoption. 

> The key difference here is that previous systems tended to operate at a lower layer (typically HTTP or TLS), which made it hard for the site to control how and when authentication happened.2 By contrast, a JS API puts the site in control so it can ask for authentication when it wants to (e.g., after showing the home page and prompting for the username)

[Stanford course on Web Security](https://twitter.com/addyosmani/status/1244172441146068992)

[Emulate authenticators and debug WebAuthn](https://developer.chrome.com/docs/devtools/webauthn/). [Enabling Strong Authentication with WebAuthn](https://developers.google.com/web/updates/2018/05/webauthn).

[yubi key generation](https://developers.yubico.com/U2F/Protocol_details/Key_generation.html). [Discoverable Credentials / Resident Keys in Webauthn](https://developers.yubico.com/WebAuthn/WebAuthn_Developer_Guide/Resident_Keys.html).

[the whole Yubykeys developer section of Webauthn is pretty good](https://developers.yubico.com/WebAuthn/)

[Does WebAuthn Replace OAuth?](https://oauth.net/webauthn/). [tweet](https://twitter.com/alexellisuk/status/1444614759677104131).

> No! In fact, WebAuthn and OAuth work great together! While WebAuthn can often take the place of using a specific third-party OAuth API for authentication, WebAuthn isn't trying to solve the same problems OAuth solves.

> WebAuthn may end up replacing the step in OAuth where the user enters their password, since WebAuthn is a replacement for password authentication. 

[What makes FIDO and WebAuthn phishing resistant?](https://community.ibm.com/community/user/security/blogs/shane-weeden1/2021/12/08/what-makes-fido-and-webauthn-phishing-resistent?CommunityKey=96f617c5-4f90-4eb0-baec-2d0c4c22ab50)

> Authenticity of the target site is the responsibility of the FIDO Client

> The FIDO Client, a computer program, is responsible for ensuring that the site to which it is connected and sending signed FIDO authentication payloads is authoritative for the rpId being used.

> Suffice to say that the browser plays a pivotal role in deciding whether a FIDO credential may be exercised in WebAuthn calls originating from a particular website, and the browser can reliably determine the site it is connected to via established https server authentication. 

> In a typical FIDO authentication scheme the responsibility of the human is to ensure they are using trusted FIDO Client software. In the case of WebAuthn this means using a browser they trust installed with a set of trusted root certificate authorities. Trust in the browser is an established universal pre-requisite for humans using web applications. Commonly the browser and its trust roots are pre-installed as part of the operating system, which the user is implicitly trusting anyway.

> FIDO authentication is considered phishing resistant because the decision about whether a particular scoped credential may be used and the results shared with a server endpoint is delegated to security mechanisms within a trusted computer program such as the browser rather than the human having to visually recognise a phishing attempt themselves. 

[WebAuthn Is Great and It Sucks](https://sec.okta.com/articles/2020/04/webauthn-great-and-it-sucks)

[‘Zero-click’ hacks are growing in popularity ](https://news.ycombinator.com/item?id=30395786)

[Mitre](https://attack.mitre.org/)

[The New OAuth 2.0 Stack in Spring Security 5](https://twitter.com/javinpaul/status/1495254708478435335).

[Oauth 2](https://oauth.net/2/). [Oauth2 simplified](https://aaronparecki.com/oauth-2-simplified/).

> Single-page apps (or browser-based apps) run entirely in the browser after loading the source code from a web page. Since the entire source code is available to the browser, they cannot maintain the confidentiality of a client secret, so the secret is not used in this case. The flow is based on the authorization code flow above, but with the addition of a dynamically generated secret used on each request. This is known as the PKCE extension.

> Note: Previously, it was recommended that browser-based apps use the "Implicit" flow, which returns an access token immediately in the redirect and does not have a token exchange step. In the time since the spec was originally written, the industry best practice has changed to recommend that the authorization code flow be used without the client secret. This provides more opportunities to create a secure flow, such as using the PKCE extension.

> Now you'll need to exchange the authorization code for an access token, but instead of providing a pre-registered client secret, you send the PKCE secret you generated at the beginning of the flow.

> The authorization server will hash the verifier and compare it to the challenge sent in the request, and only issue the access token if they match. This ensures that even if someone was able to intercept the authorization code, they will not be able to use it to get an access token since they won't have the secret.

> If the service does not have a native application, you can launch a mobile browser to the standard web authorization URL. Note that you should never use an embedded web view in your own application, as this provides the user no guarantee that they are actually are entering their password in the service's website rather than a phishing site.

[Using OAuth 2.0 to Access Google APIs](https://developers.google.com/identity/protocols/oauth2)

[Doesn't OAuth 2.0 PKCE Flow open the door to masquerading/phishing attacks?](https://stackoverflow.com/questions/64436989/doesnt-oauth-2-0-pkce-flow-open-the-door-to-masquerading-phishing-attacks)

> Without PKCE, it's hard to fake an app and obtain a refresh token because that would require an attacker to obtain client_secret.

> When you set up the application on the oauth2 server, you have to set up a number of redirect_uris, allowed places to return to after authorization is complete. This means that someone who creates a phishing attack like the one you described cannot return to their own app after login, and will never receive the code.

[consent phishing & Oauth 2](https://resources.infosecinstitute.com/topic/consent-phishing-how-attackers-abuse-oauth-2-0-permissions-to-dupe-users/). [more](https://www.microsoft.com/security/blog/2021/07/14/microsoft-delivers-comprehensive-solution-to-battle-rise-in-consent-phishing-emails/).

[Attacking and Defending OAuth 2.0](https://www.praetorian.com/blog/attacking-and-defending-oauth-2-0-part-1/)

[OAuth 2.0 vs Session Management](https://supertokens.com/blog/oauth-2-vs-session-management)

[All you need to know about user session security](https://supertokens.com/blog/all-you-need-to-know-about-user-session-security)

[csrf](https://owasp.org/www-community/attacks/csrf). [SameSite cookies](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie/SameSite). [](). 

> This attack is not used to steal auth tokens — instead, it allows an attacker to piggyback on an existing active session (read more here).

> Prevention of CSRF attacks typically requires the use of an anti-CSRF token or SameSite cookies. 

[Defending against CSRF with SameSite cookies](https://portswigger.net/web-security/csrf/samesite-cookies)

> If the SameSite attribute is set to Strict, then the browser will not include the cookie in any requests that originate from another site. This is the most defensive option, but it can impair the user experience, because if a logged-in user follows a third-party link to a site, then they will appear not to be logged in, and will need to log in again before interacting with the site in the normal way.

[Do I still need CSRF protection when SameSite is set to Lax?](https://security.stackexchange.com/questions/234386/do-i-still-need-csrf-protection-when-samesite-is-set-to-lax)

[Is multifactor authentication less effective than it used to be?](https://slate.com/technology/2022/02/google-multifactor-authentication-effective-research.html) 

[Phishing with an in-browser remote desktop](https://news.ycombinator.com/item?id=30435326)

[Implementing "Log in with GitHub"](https://getlotus.app/6-implementing-log-in-with-github). [Sign In with Github Tutorial](https://www.back4app.com/docs/platform/sign-in-with-github). [Log In With GitHub](https://laracasts.com/series/learn-socialite/episodes/1).

[How I use AWS Security Hub](https://www.youtube.com/watch?v=BNH7b3YBmWM)

[OAuth 2.0 and OpenID Connect protocols on the Microsoft identity platform](https://docs.microsoft.com/en-us/azure/active-directory/develop/active-directory-v2-protocols)

[Login with a Public Ed25519 Key (broken)](https://news.ycombinator.com/item?id=30483727)

[GitHub’s database of security advisories is now open source](https://news.ycombinator.com/item?id=30480862)

[Anatomy of a JWT](https://news.ycombinator.com/item?id=30499618)

[Why you probably don't need OAuth2 / OpenID Connect](https://www.ory.dev/oauth2-openid-connect-do-you-need-use-cases-examples/). [OAuth 2.0 flows explained in GIFs](https://dev.to/hem/oauth-2-0-flows-explained-in-gifs-2o7a). [OAuth is Not Authentication](https://www.scottbrady91.com/oauth/oauth-is-not-authentication). [Clients shouldn’t peek inside access tokens](https://www.cloudidentity.com/blog/2018/04/20/clients-shouldnt-peek-inside-access-tokens/). [The problem with OAuth for Authentication](http://www.thread-safe.com/2012/01/problem-with-oauth-for-authentication.html). [What is OpenID Connect?](https://www.scottbrady91.com/openid-connect/openid-connect-overview). [Understanding identity tokens](https://www.scottbrady91.com/openid-connect/identity-tokens). [OpenID Connect Endpoints](https://www.scottbrady91.com/openid-connect/openid-connect-endpoints). [OpenID Connect Flows](https://www.scottbrady91.com/openid-connect/openid-connect-flows).

> Allow third parties to authenticate you via your e.g. Facebook account (OpenID Connect).

> If you are new to OAuth2, it might be confusing why you need OpenID Connect. The two are interlinked yet different. The main distinguishing factor is the audience of the resulting tokens:
> OAuth2's tokens (OAuth2 Access Token) have the first party server as their target audience.
> OpenID Connect's tokens (ID Token) have the third party client as their target audience.

> TL;DR: OAuth != authentication. If you need to know the users identity then use OpenID Connect, don’t hack it yourself.

> When an authorization server issues an access token, the intended audience is
> the protected resource. After all, this is what the token is providing access
> to. It’s down to the protected resource to understand and validate the token.
> One of the benefits of OAuth is that the protected resource doesn’t even need
> to know who the requesting client application is, just what permissions it
> has been delegated.

> There is no standard structure for an access token. So even though the past
> two points sound like they could be worked around, there’s no guarantee that
> your client application would be able to understand it.  If you are relying
> on an access token being a structured piece of data, there’s also no reason
> it can’t change its structure at any time. Only the authorization server and
> relying parties get a say in the access token structure; client applications
> don’t get a say.

> OpenID Connect (OIDC) provides a simple identity layer on top of the OAuth
> 2.0 protocol, enabling Single Sign-On (SSO) and API access in one round trip.
> It brings the missing user authentication story and identity layer to OAuth.

> OpenID Connect achieves this using identity tokens, and a new API called the
> user info endpoint. It turns your OAuth authorization server into an identity
> provider (or OpenID provider).

> An identity token describes the authentication event that took place at the
> identity provider. It contains information such as when the user last
> authenticated and how they authenticated. An identity token is always a
> signed JSON Web Token (JWT).

> Single LogOut (SLO) and session management.

> OpenID 1.0 and 2.0 are obsolete specifications that pre-date OpenID Connect by almost 10 years. OpenID was a separate, custom authentication protocol, not related to OAuth or OpenID Connect.

> OpenID didn’t see much adoption; however, OpenID Connect is has seen significant success working alongside OAuth, replacing older protocols such as WS-Federation and SAML as the go-to for SSO.

> OAuth is not authentication. It’s an authorization protocol, or, better yet, a delegation protocol

[OpenSSH 8.9](https://news.ycombinator.com/item?id=30513246)

[1password working from home](https://1password.com/working-from-home/). [1password business](https://1password.com/business/). [How to get started with 1Password](https://www.youtube.com/watch?v=8UQnkKUgdHk). [10 best features of 1Password](https://www.youtube.com/watch?v=_gkLElDiFnw). Provide secret key on each new device? [Get to know 1Password in your browser](https://www.youtube.com/watch?v=YaUE11OOrME)

[Understand Amazon Cognito user pools and identity pools](https://aws.amazon.com/premiumsupport/knowledge-center/cognito-user-pools-identity-pools/)

[Where’s My Secret Access Key? (aws)](https://aws.amazon.com/blogs/security/wheres-my-secret-access-key/)

[Why Single Sign on Sucks](https://news.ycombinator.com/item?id=30646081)

[A Summary of OAuth 2.0 Attack Methods](https://news.ycombinator.com/item?id=30717470)

[Understanding The Web Security Model, Part III: Basic Principles and the Origin Concept](https://educatedguesswork.org/posts/web-security-model-origin/)

[If you’re not using SSH certificates you’re doing SSH wrong (2019)](https://news.ycombinator.com/item?id=30788544)

[Authorization in a Microservices World](https://news.ycombinator.com/item?id=30878926). [Patterns for Authorization in Microservices](https://www.osohq.com/post/microservices-authorization-patterns)

[The complete guide to protecting your APIs with OAuth2](https://stackoverflow.blog/2022/04/11/the-complete-guide-to-protecting-your-apis-with-oauth2/)

[WebAuthn Browser Support](https://news.ycombinator.com/item?id=31162070)

[OAuth 2.0 and OpenID Connect (in plain English)](https://www.youtube.com/watch?v=996OiexHze0)

[Securing SPAs with Spring](https://www.youtube.com/watch?v=AE_Srj6r4Rc)



